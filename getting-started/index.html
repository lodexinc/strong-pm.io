<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>StrongLoop Process Manager</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,300italic,400italic,500italic">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu+Mono">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="stylesheet" href="/css/main.css">
    <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-placeholder/2.0.7/jquery.placeholder.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/0.6.11/fastclick.min.js"></script>
    <script src="/js/prism.js"></script><script>$('input, textarea').placeholder();</script>
    <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"></script><![endif]-->
    <script src="/js/main.js"></script>
  </head>
  <body class="l-page-getting-started -getting-started-index js-body">
  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5XL76H"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5XL76H');</script>
  <!-- End Google Tag Manager -->
    <div class="c-wrapper js-wrapper">
      <header class="c-masthead">
        <div class="c-container x-flex-v js-masthead-container">
          <a href="/" class="_logo x-flex-v">
            <h1 class="c-heading -h3">StrongLoop<br/> Process Manager</h1>
          </a>
          <nav class="_nav js-masthead-nav">
            <ul class="_nav-list js-nav-list">
              <li class="_nav-item"><a href="/">About</a></li>
              <li class="_nav-item "><a href="/compare">Compare</a></li>
              <li class="_nav-item -active"><a href="/getting-started">Local Use</a></li>
              <li class="_nav-item"><a href="/prod">Remote Use</a></li>
              <li class="_nav-item"><a href="/resources">Resources</a></li>
            </ul>
          </nav>
          <button class="_menu js-menu">
            <i class="fa fa-bars"></i>
            <span class="x-hide">Menu</span>
          </button>
          <iframe src="http://ghbtns.com/github-btn.html?user=strongloop&repo=strong-pm&type=watch&count=true" class="c-github-star js-github-star"></iframe>
        </div>
      </header>

      <main class="c-content">
        <section class="c-section">
          <div class="c-container -padded">
            <h1 class="c-heading -h2">Use locally on your workstation</h1>
            <p><b>Assuming you have already installed Node...</b></p>

            <p>For information on using on a production host, see <a href="/prod">Remote Use</a>.</p>
          </div>
        </section>

        <section class="c-section x-greylight"><a name="install"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#install">Install</a> </h2>

            <div class="c-grid">
              <div class="_col -col-1-2">
                <p>Install the full StrongLoop module that includes the client tools (Arc and <span class="cmd">slc</span>) and StrongLoop Process Manager
                on your workstation for development and testing.
                </p>
                <p>For more information, see <a href="http://docs.strongloop.com/display/SL">Installing StrongLoop</a>.</p>
              </div>
              <div class="_col -col-1-2">
                <pre><code class="language-bash">$ npm install -g strongloop</code></pre>
              </div>
            </div>
          </div>
        </section>

        <section class="c-section "><a name="start"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#start"> Start application </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-4">
                <p>Get an app if you don't have one handy. </p>
              </div>
              <div class="_col -col-3-4">
<pre><code class="language-bash">$ git clone https://github.com/strongloop/express-example-app.git
</code></pre>
              </div>
            </div>

            <div class="c-grid">
              <div class="_col -col-1-4">
                <p>After installing dependencies, start Process Manager locally and deploy the app to it. </p>
                <p>Open <a href="http://localhost:3001">http://localhost:3001</a> to see the app home page.</p>
              </div>
              <div class="_col -col-3-4" >
<pre><code class="language-bash">$ cd express-example-app
$ npm install
$ slc start
Process Manager is attempting to run app `.`.

  To confirm it is started: slc ctl status express-example-app
  To view the last logs: slc ctl log-dump express-example-app
  To see more options: slc ctl -h
  To see metrics, the profilers and other diagnostic features run: slc arc
</code></pre>
              </div>
            </div>

          </div>
        </section>

        <section class="c-section x-greylight"><a name="status"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#status"> Display app status </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-1">
                <p>Get a quick status overview with all worker PIDs, cluster IDs, other key information.</p>

               <!-- <p>NOTE: Default is PM control endpoint is <span style="font-family: monospace;">localhost:8701</span>,
                but it's given here to illustrate you could also specify a remote host.</p>  -->
              </div>
            </div><div class="c-grid">
              <div class="_col -col-1-1">
                <pre><code class="language-bash">$ slc ctl
Service ID: 1
Service Name: express-example-app
Environment variables:
  No environment variables defined
Instances:
    Version  Agent version  Cluster size
     4.1.0       1.5.1            4
Processes:
        ID      PID   WID  Listening Ports  Tracking objects?  CPU profiling?
    1.1.58223  58223   0
    1.1.58224  58224   1     0.0.0.0:3001
    1.1.58225  58225   2     0.0.0.0:3001
    1.1.58226  58226   3     0.0.0.0:3001
    1.1.58227  58227   4     0.0.0.0:3001
</code></pre>
              </div>
              <p>This tells you the app is running as a service called "express-example-app" with service ID 1.</p>
              <p>
              By default, Process Manager uses a service name from the <span style="font-family: monospace;">name property</span>
              of the application's <span style="font-family: monospace;">package.json</span>.
              So, if you're not using express-example-app, then your service name will be different.
              </p>
            </div>
          </div>
        </section>

        <section class="c-section "><a name="cluster"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#cluster"> Change cluster size  </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-1">
            <p>By default the Process Manager runs one process per CPU.  So, on a four-core system
            it will run the app in a four-process cluster.  </p>
              </div>
            </div>
<br/>
            <div class="c-grid">
              <div class="_col -col-1-3">
            <p>You can easily change the cluster size.  If you're not using express-example-app, be sure to substitute your service name in the command.</p>
            <p>Now if you display status again, you'll see only two worker processes running:</p>
              </div>
              <div class="_col -col-2-3">
                <pre><code class="language-bash">$ slc ctl set-size express-example-app 2
$ slc ctl
...
Processes:
        ID      PID   WID  Listening Ports  Tracking objects?  CPU profiling?
    1.1.58223  58223   0
    1.1.58224  58224   1     0.0.0.0:3001
    1.1.58225  58225   2     0.0.0.0:3001</code></pre>
              </div>
          </div>
          <div class="c-grid">
            <div class="_col -col-1-1"><br/>
              <p>For more information see
              <a href="http://docs.strongloop.com/display/SLC/Scaling+to+multiple+processes">Scaling to multiple processes</a> in the documentation.</p>
            </div>
          </div>
        </section>

        <section class="c-section x-greylight"><a name="logs"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#logs"> View logs </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-2">
                Follow your logs live in the console.
              </div>
              <div class="_col -col-1-2" style="margin-bottom: 10px;">
                <pre><code class="language-bash">$ slc ctl log-dump express-example-app --follow</code></pre>
              </div>

              <div class="_col -col-1-1">
                <pre><code class="language-markup" style="font-size: 85%">2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO strong-agent using collector https://collector.strongloop.com:443
2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO strong-agent v1.3.2 profiling app 'express-example-app' pid '70339'
2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO strong-agent[70339] started profiling agent
2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO supervisor starting (pid 70339)
2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO strong-agent strong-agent using strong-cluster-control v2.0.0
2015-03-25T04:21:08.447Z pid:70339 worker:0 INFO supervisor reporting metrics to `internal:`
2015-03-25T04:21:08.451Z pid:70339 worker:0 INFO supervisor size set to 4
2015-03-25T04:21:08.455Z pid:70339 worker:0 INFO supervisor listening on 'runctl'
2015-03-25T04:21:08.521Z pid:70339 worker:0 INFO supervisor started worker 1 (pid 70340)
2015-03-25T04:21:08.656Z pid:70339 worker:0 INFO supervisor started worker 2 (pid 70341)
2015-03-25T04:21:08.775Z pid:70339 worker:0 INFO supervisor started worker 3 (pid 70342)
2015-03-25T04:21:08.948Z pid:70340 worker:1 INFO strong-agent[70340] started profiling agent
2015-03-25T04:21:08.949Z pid:70339 worker:0 INFO supervisor started worker 4 (pid 70343)
2015-03-25T04:21:08.950Z pid:70339 worker:0 INFO supervisor resized to 4
2015-03-25T04:21:08.970Z pid:70339 worker:0 INFO strong-agent[70339] connected to collector
2015-03-25T04:21:09.030Z pid:70341 worker:2 INFO strong-agent[70341] started profiling agent
2015-03-25T04:21:09.082Z pid:70340 worker:1 Listening on port: 3000
2015-03-25T04:21:09.159Z pid:70342 worker:3 INFO strong-agent[70342] started profiling agent
2015-03-25T04:21:09.229Z pid:70343 worker:4 INFO strong-agent[70343] started profiling agent
2015-03-25T04:21:09.231Z pid:70341 worker:2 Listening on port: 3000
2015-03-25T04:21:09.758Z pid:70342 worker:3 Listening on port: 3000
2015-03-25T04:21:09.759Z pid:70343 worker:4 Listening on port: 3000
2015-03-25T04:21:09.760Z pid:70340 worker:1 INFO strong-agent[70340] connected to collector
2015-03-25T04:21:09.840Z pid:70341 worker:2 INFO strong-agent[70341] connected to collector
2015-03-25T04:21:09.873Z pid:70342 worker:3 INFO strong-agent[70342] connected to collector
2015-03-25T04:21:09.955Z pid:70343 worker:4 INFO strong-agent[70343] connected to collector
</code></pre>
              </div>
            </div>
          </div>
        </section>

        <section class="c-section "><a name="env"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#env"> Update your environment with no downtime </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-3">
                <p>Use the <span class="cmd">ctl env-set</span> command to change environment variables on the fly.</p>
              </div>
              <div class="_col -col-2-3">
                <pre><code class="language-bash">$ slc ctl env-set express-example-app NODE_ENV=production
Environment updated: Updated environment, restarting app </code></pre>
              </div>
            </div>
          </div>
        </section>

        <section class="c-section x-greylight"><a name="profile"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#profile"> View CPU and memory profiles </a></h2>
            <div class="c-grid">
              <div class="_col -col-1-1">
                <p>To get meaningful data, run the profiler while your application is under typical or high load.</p>
              </div>
              <div class="_col -col-2-5">
<br/>
                <ol>
                  <li>Determine the process ID of one of the worker processes with <span class="cmd">slc ctl</span>,
                  <a href="#status">as you did above</a>.</li>
                  <li>Start the CPU profiler for the process, as shown in the example at right.</li>
                  <li>Let the profiler run for five to ten seconds.</li>
                  <li>Stop the CPU profiler, as shown in the example at right.</li>
                </ol>
              </div>
              <div class="_col -col-3-5">
                <pre><code class="language-bash">$ slc ctl cpu-start 1.1.58224
Profiler started, use cpu-stop to get profile
</code></pre>
<pre><code class="language-bash">$ slc ctl cpu-stop 1.1.58224
CPU profile written to `node.1.1.58224.cpuprofile`,
load into Chrome Dev Tools
</code></pre>
              </div>
            </div>
<br/>
            <div class="c-grid">
              <div class="_col -col-1-2" >
                  <p>Start StrongLoop Arc and log in to view the profile data.</p>
              </div>
              <div class="_col -col-1-2" >
                <pre><code class="language-bash">$ slc arc</code></pre>
              </div>
            </div>

            <div class="c-grid top-pad" >
              <div class="_col -col-1-2" >
                <img src="/images/arc splash.png" class="c-fleximg" />
              </div>
              <div class="_col -col-1-2">
                  <p style="margin-top: 30px;">In Arc, click <b>Profiler</b>.</p>
              </div>
            </div>

            <div class="c-grid top-pad" >
              <div class="_col -col-1-2" >
                <p>In Arc Profiler:</p>
                <ol>
                  <li>Click <b>File</b> to load the profile you just generated.</li>
                  <li>Make sure "JavScript/Node.js CPU Profile" is selected.</li>
                  <li>Click <b>Load</b>.</li>
                  <li>Choose the .cpuprofile file you generated.  The file will then be listed in in the <b>Profiles</b> list.</li>
                  <li>Click on the file name in the Profiles list.  You'll see the CPU profile data, as illustrated below. </li>
                </ol>
              </div>
              <div class="_col -col-1-2" >
                <img src="/images/arc-profiler-file.png" class="c-fleximg"/>
              </div>
            </div>

            <div class="c-grid top-pad">
              <div class="_col -col-3-4">
                <img src="/images/arc-cpu-profile.png" class="c-fleximg"/>
              </div>
            </div>

            <div class="c-grid top-pad" >
              <div class="_col -col-2-3">
                <p>Click the inverted triangle to display the data in different ways.</p>
              </div>

              <div class="_col -col-1-3">
                <img src="/images/devtools-cpu-chooser.png" class="c-fleximg"/>
              </div>
            </div>
<br/>
            <div class="c-grid top-pad" >
              <div class="_col -col-1-2">
                <p>You can generate heap snapshots following the same process.
                Just use this command instead (for example for pid 22670):</p>
              </div>
              <div class="_col -col-1-2">
                <pre><code class="language-bash">$ slc ctl heap-snapshot 1.1.22670</code></pre>
              </div>
            </div>

            <div class="c-grid top-pad">
              <div class="_col -col-3-4">
                <p>For more information, see <a href="http://docs.strongloop.com/display/SLC/Profiling">Profiling</a> in the documentation.</p>
              </div>
            </div>
        </section>

        <section class="c-section "><a name="metrics"></a>
          <div class="c-container -padded">
            <h2 class="c-heading -h3"><a href="#metrics"> Monitor performance metrics </a></h2>

            <div class="c-grid">
              <div class="_col -col-1-1" style="margin-bottom: 10px;">
                <p>Monitoring performance metrics requires a StrongLoop product license key.
                You automatically get a free trial license key valid for 30 days from the first time you run Arc.
                For more information, see <a href="http://docs.strongloop.com/display/SL/Managing+your+licenses">Managing your licenses</a>.
                </p>
              </div>
              <div class="_col -col-3-4">
                <ol>
                  <li>Start Arc and log in.</li>
                  <li>Click <b>Metrics</b>.
                  <br/>Arc will show the process IDs (PIDs) for the local app </li>
                  <li>Click <b>Load</b>.</li>
                </ol>
                  <p>Wait a minute or two and you will see peformance metrics, including statistics on CPU use, event loop execution,
                  and heap memory consumption for the selected process, for example, as shown below.</p>
              </div>
            </div>

            <div class="c-grid">
              <div class="_col -col-3-4">
                <img src="/images/arc-metrics.png" class="c-fleximg"/>
                <p>NOTE: Depending on the application your're using, your metrics graphs might not be as interesting as those shown here.</p>
              <p>For details on the available metrics,
                see <a href="http://docs.strongloop.com/display/SLC/Viewing+metrics+with+Arc#ViewingmetricswithArc-Availablemetrics">Available metrics</a>.</p>
              </div>
            </div>
          </div>
        </section>

      </main>
      <footer class="c-footer x-green">
        <div class="c-container -padded">
          <nav class="_nav">
            <ul class="_nav-list js-nav-list">
              <li class="_nav-item"><a href="/">About</a></li>
              <li class="_nav-item"><a href="/compare">Compare</a></li>
              <li class="_nav-item -active"><a href="/getting-started">Local Use</a></li>
              <li class="_nav-item"><a href="/prod">Remote Use</a></li>
              <li class="_nav-item"><a href="/resources">Resources</a></li>
              <!-- <li class="_nav-item"><a href="/users">Who's using?</a></li> -->
            </ul>
          </nav>
          <p class="_copyright">© Copyright 2015 StrongLoop, Inc.</p>
          <iframe src="http://ghbtns.com/github-btn.html?user=strongloop&amp;repo=strong-pm&amp;type=follow" class="c-github-follow"></iframe>
        </div>
      </footer>
    </div>
  </body>
</html>
